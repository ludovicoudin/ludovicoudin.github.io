<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Direction de thèses – ludovicoudin.github.io</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8647a4a42273f773479d27c00df3f9ed.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ludovicoudin.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#thèses-en-cours" id="toc-thèses-en-cours" class="nav-link active" data-scroll-target="#thèses-en-cours">Thèses en cours</a></li>
  <li><a href="#thèses-soutenues" id="toc-thèses-soutenues" class="nav-link" data-scroll-target="#thèses-soutenues">Thèses soutenues</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Direction de thèses</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="thèses-en-cours" class="level2">
<h2 class="anchored" data-anchor-id="thèses-en-cours">Thèses en cours</h2>
</section>
<section id="thèses-soutenues" class="level2">
<h2 class="anchored" data-anchor-id="thèses-soutenues">Thèses soutenues</h2>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.fr/s384024"><img src="files/supervision/lalonde.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Morgane Lalonde (2024)</strong></p>
<p><strong>Urban effects on the hydroclimate: observed and modeled analyses</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Sophie Bastin (LATMOS)</p>
<p>Financement EUR IPSL-CGS</p>
<details>
<summary>
Abstract
</summary>
<p>Urban water management is evolving in response to the increasing urban population, rising demand for water supply, climate change, and urban-induced changes in regional hydroclimate. Ensuring a sustainable approach to urban water management requires a deeper understanding of the urban hydroclimate. This thesis addresses this need by investigating urban effects on precipitation, influences on natural surface properties, and the interactions between atmospheric and hydrological systems in shaping the urban hydroclimate. A multidisciplinary approach is adopted, integrating insights from both atmospheric and hydrological sciences and combining empirical analyses of observed data with modeling to provide complementary perspectives. The study begins by examining urban effects on precipitation through a combination of literature review and machine learning to assess any consensus. Given the lack of agreement among studies using radar precipitation data, a consistent wind-based radar methodology is applied to a broad sample of cities over the USA and Europe. This approach aims to determine if urban areas have a consistent influence on precipitation patterns across regions, addressing the challenge of generalizing urban effects on precipitation. The modeling aspect includes a review of existing urban land surface models, focusing on their representation of surface hydrological processes and energy fluxes. This is followed by the development of a new urban surface scheme for the ORCHIDEE model, incorporating urban heterogeneities and representation of imperviousness.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-04155520"><img src="files/supervision/lemaitre_basset.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Thibault Lemaitre-Basset (2023)</strong></p>
<p><strong>Importance de la demande en eau atmosphérique et anthropique en contexte de changement climatique sur la durabilité de la gestion de la ressource : cas d’étude du bassin versant de la Moselle en France</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Guillaume Thirel (INRAE- UR HYCAR)</p>
<p>Financement ED GRNE</p>
<details>
<summary>
Abstract
</summary>
<p>The climate projections analysed in the IPCC reports indicate an increase in air temperature ranging from +2 to +6 °C on average by 2100. A warming of this magnitude and speed is unprecedented, and it is due to human activities. Despite this fact, a reduction in greenhouse gas emissions does not seem to be in sight within a reasonable time frame. It is therefore necessary to think about adaptation strategies to mitigate the deleterious impacts of climate change. The water cycle is directly impacted by climate change, through an increase in atmospheric water demand that could lead to an increase in evapotranspiration, and through an increase in anthropogenic pressure on water resources, whose reserves may change. By relying on hydrological simulations under climate change scenarios, stakeholders can assess the magnitude of future changes. However, hydrological models often rely on stationarity assumptions that may not be valid under global change. The overall objective of this thesis is to introduce methodologies that implement hydrological modelling frameworks more suited to deal with the challenges faced by stakeholders in sustainable water resource management.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-03469456v1"><img src="files/supervision/peredo.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Daniela Peredo (2021)</strong></p>
<p><strong>Quels gains d’une modélisation hydrologique adaptée et d’une approche d’ensemble pour la prévision des crues rapides ?</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Maria-Helena Ramos (INRAE- UR HYCAR)</p>
<p>Financement ED GRNE</p>
<details>
<summary>
Abstract
</summary>
<p>Flood forecasting plays a fundamental role in anticipating and implementing measures to protect lives and property. The objective of this thesis is to investigate our ability to improve the simulation and forecasting of major flash flood events in France. First, we analyse the limitations of the lumped hydrological modelling approach, and how the contribution of the semi-distributed hydrological model GRSD, with fine mesh and hourly time step, to improve the simulation of major flood events. We also propose a modification of the structure of the model, in order to make it better suited to reproducing the response of the catchments to high rainfall intensities. An adaptation of the model structure, based on the calculation of the production rate function, resulted in the introduction of a new parameter and the proposal of a new model (GRSDi) capable of better simulating the hydrological response to heavy rains that occur in autumn, after a dry summer period. Second, we explore the ability of a meteorological ensemble prediction approach, combined with the semi-distributed hydrological model, to better predict flash flood events, the amplitude and the time of occurrence of peak flows, whether in gauged or ungauged basins. The results made it possible to identify, from a hydrological point of view, the strengths and weaknesses of the products evaluated. The work carried out constitutes a step forward towards the use of conceptual, continuous and semi-distributed hydrological models for the forecasting of major flood events and flash floods in the Mediterranean context.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-03250292"><img src="files/supervision/saadi.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Mohamed Saadi (2020)</strong></p>
<p><strong>Représentation de l’urbanisation dans la modélisation hydrologique à l’échelle du bassin versant</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Pierre Ribstein (METIS)</p>
<p>Financement ED GRNE</p>
<details>
<summary>
Abstract
</summary>
<p>In order to determine the hydrological impact of future urban development, hydrological modeling is very useful because it allows obtaining hydrological scenarios from urbanization scenarios by considering climate variability. Despite the current diversity of applicable hydrological models to urbanized catchments, those models were generally tested on few catchments, which raises the question of their robustness. The objective of this thesis is to look for a hydrological model structure that is able to reproduce the rainfall-runoff relationship for a large sample of urbanized catchments, located in France and the United States, and characterized by a wide variety of urban sprawl. To do so, we started from an hourly conceptual model structure (GR4H) which was not specifically developed nor tested on highly urbanized catchments. We followed four steps: (1) The collection and preparation of a large sample of data for more than 2000 catchments located in France and the United States. The analysis of the variability of event runoff ratio for 852 US catchments showed the dependence of catchment response not only on mean total impervious area (TIA), but also on antecedent soil moisture conditions regardless of the level of urban sprawl in the catchment; (2) The test of the starting model structure on highly urbanized catchments. This step showed the ability of GR4H parameters to reflect the behavioral specificities of urbanized catchments; (3) The regionalization of GR4H parameters in order to relate them to the fraction of urban cover in the catchment. The obtained regression relationships performed well but showed weak sensitivity to change in the fraction of urban cover, which impeded their use for scenario prediction; (4) The step-by-step modification of the GR4H model structure by including excess rainfall on impervious surfaces, and by varying the partitioning between quick flow and slow flow depending on each catchment. The evaluation of these modifications on 273 urbanized catchments indicated an improvement in reproducing the observed flows in comparison to the original structure, especially during dry and flooding periods. The added parameters showed a strong dependence on the mean total impervious area. This thesis work illustrates a constructive modeling approach by which we have succeeded in both (1) improving the representation of urbanization within the model and (2) obtaining better simulation of catchment response. An effort of regionalizing the new model structure using measures of urban landscape fragmentation will allow to better estimate the impact of different urban planning schemes on the hydrological behavior at the catchment scale.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-01624530"><img src="files/supervision/garcia.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Florine Garcia (2016)</strong></p>
<p><strong>Amélioration d’une modélisation hydrologique régionalisée pour estimer les statistiques d’étiage</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Nathalie Folton (INRAE - UR RECOVER)</p>
<p>Financement bourse INRAE</p>
<details>
<summary>
Abstract
</summary>
<p>Estimating low-flow indices is of paramount importance to understand low flows and to manage water resources and risk assessments. These indices are derived from time-series of river discharges that are measured at gauged sites over long periods. At ungauged sites, the indices must be estimated. This research work is part of a project to improve “LoiEau”, a software package that is used by French regional environmental or water agencies. The main objective is to develop a simple and flexible rainfall-runoff model to simulate low-flow indices of ungauged sites at daily or longer time intervals. The model simplicity relies on the strong assumption that two free parameters are sufficient to provide accurate enough estimates of low-flow indices, yet making easier the regionalisation of models. The model accuracy depends on the objective function that is used to calibrate model parameters on gauged sites and had to be adapted to low-flow simulations. The model is flexible in the sense that it is designed to fit to a wide variety of catchments and hydro-meteorological behaviours. This model was compared with GR4J, a daily rainfall-runoff model which involves four parameters, and LoiEau, a monthly model. Comparisons were also carried out with a stochastic estimation method applied to a specific low-flow index. This research work shows the potential of the two-parameter model, but also the advantage of a daily time step to account for the temporal variability of precipitations, which is not without consequence on the assessment of average discharges due to the nonlinearity of rainfall-runoff models.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-01529196v1"><img src="files/supervision/poncelet.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Carine Poncelet (2016)</strong></p>
<p><strong>Du bassin au paramètre : jusqu’où peut-on régionaliser un modèle hydrologique conceptuel ?</strong></p>
<p>Financement Kic-Climat</p>
<details>
<summary>
Abstract
</summary>
<p>Water resources are variable in time and space. Hydrological models are required to assess these resources and have to cope with catchments complexity and measurement limits. Most of the catchments are gauged which means that streamflow measurements are available at the catchment outlet. In particular, streamflow measurements can be used to analyse the catchment hydrological behavior and calibrate model parameters. However for ungauged catchments, the hydrological behavior must be define by other ways and model parametrisation must be assessed through regionalization instead of calibration.Regionalization studies rely on gauged catchments to developp methodologies applicable to ungauged catchments. They cover a large range of applications from hydrological signatures predictions (mean streamflow, regime, flow duration curves …) to low-flow or flood predictions. The present work aims at estimating streamflow hydrographs in ungauged catchments by regionalizing hydrological model parameters.Several methods have been developped to solve this problem and they mostly rely on the knowledge of parameter sets on gauged catchments to find the best way to transfer the parameters sets between catchments. Gauged catchments are then considered as donor catchments while ungauged catchments are receiver: the challenge of transfert-based methods being to assign the correct donnor to each receiver. However, these methods make two strong hypothesis: (i) parameters sets calibrated on gauged catchments are reliable and (ii) similar gauged and ungauged catchments can be accurately matched during the transfer. However, those hypothesis do not always seem to hold true. In this context, regional calibration appears as a promising way for hydrological model regionalization since regional calibration look for common parameter sets on several catchments. This way, parameters are known with less uncertainties on gauged catchment and parameters regionalization is joined with calibration. The challenge of this PhD thesis is to develop and apply a regionalization scheme, based on regional calibration, to the GR6J hydrological model. On a large dataset, we have studied if regional calibration is a competitive solution to regionalize hydrological models compared to existing methodologies (i.e.&nbsp;transfer-based methods).As a prelude to the regionalization study, we paid attention to analyse the model on gauged catchments. In particular, we analysed the model sensitivity to its parameters to define the functionnal role of each parameter. Eight model parametrisation schemes were tested to identify the hydrologically optimal parameter set, i.e.&nbsp;a parameter set that is only catchment-dependant and do not depend on calibration strategy. Secondly we present an inovative method called “group calibration”, based on regional calibration, to link model parameters and hydrological descriptors. This method is fit for taking into account compensations between model parameters, allows the hydrological interpretation of the obtained relationships and is competitive to existing methods. Last, we conceptualize the regionalization methods to better undestand how to best value regional informations and increase model performance in extrapolation. We show that all methods set a ceilling and that space for improvement do not lie in the correct matching of donnor and reciever catchments but in the identification of more easily transferable informations.</p>
</details>
</div>
</div>
<div class="grid">
<div class="g-col-12 g-col-md-4">
<p><a href="https://theses.hal.science/tel-01529196v1"><img src="files/supervision/salavati.png" class="img-fluid"></a></p>
</div>
<div class="g-col-12 g-col-md-8">
<p><strong>Bahar Salavati (2015)</strong></p>
<p><strong>Impact de l’urbanisation sur la réponse hydrologique des bassins versants urbains</strong></p>
<p>Sorbonne Université - Direction : Ludovic Oudin (METIS) &amp; Pierre Ribstein (METIS)</p>
<p>Financement Campus France - CNOUS</p>
<details>
<summary>
Abstract
</summary>
<p>Water resources are variable in time and space. Hydrological models are required to assess these resources and have to cope with catchments complexity and measurement limits. Most of the catchments are gauged which means that streamflow measurements are available at the catchment outlet. In particular, streamflow measurements can be used to analyse the catchment hydrological behavior and calibrate model parameters. However for ungauged catchments, the hydrological behavior must be define by other ways and model parametrisation must be assessed through regionalization instead of calibration.Regionalization studies rely on gauged catchments to developp methodologies applicable to ungauged catchments. They cover a large range of applications from hydrological signatures predictions (mean streamflow, regime, flow duration curves …) to low-flow or flood predictions. The present work aims at estimating streamflow hydrographs in ungauged catchments by regionalizing hydrological model parameters.Several methods have been developped to solve this problem and they mostly rely on the knowledge of parameter sets on gauged catchments to find the best way to transfer the parameters sets between catchments. Gauged catchments are then considered as donor catchments while ungauged catchments are receiver: the challenge of transfert-based methods being to assign the correct donnor to each receiver. However, these methods make two strong hypothesis: (i) parameters sets calibrated on gauged catchments are reliable and (ii) similar gauged and ungauged catchments can be accurately matched during the transfer. However, those hypothesis do not always seem to hold true. In this context, regional calibration appears as a promising way for hydrological model regionalization since regional calibration look for common parameter sets on several catchments. This way, parameters are known with less uncertainties on gauged catchment and parameters regionalization is joined with calibration. The challenge of this PhD thesis is to develop and apply a regionalization scheme, based on regional calibration, to the GR6J hydrological model. On a large dataset, we have studied if regional calibration is a competitive solution to regionalize hydrological models compared to existing methodologies (i.e.&nbsp;transfer-based methods).As a prelude to the regionalization study, we paid attention to analyse the model on gauged catchments. In particular, we analysed the model sensitivity to its parameters to define the functionnal role of each parameter. Eight model parametrisation schemes were tested to identify the hydrologically optimal parameter set, i.e.&nbsp;a parameter set that is only catchment-dependant and do not depend on calibration strategy. Secondly we present an inovative method called “group calibration”, based on regional calibration, to link model parameters and hydrological descriptors. This method is fit for taking into account compensations between model parameters, allows the hydrological interpretation of the obtained relationships and is competitive to existing methods. Last, we conceptualize the regionalization methods to better undestand how to best value regional informations and increase model performance in extrapolation. We show that all methods set a ceilling and that space for improvement do not lie in the correct matching of donnor and reciever catchments but in the identification of more easily transferable informations.</p>
</details>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ludovicoudin\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>